---
name: ai-pm-prd
description: >-
  PRD 生成技能。整合分析、竞品、用户故事等输入，输出完整的 PRD 文档。
  基于用户上传的模板格式（8章结构），包含修订日志、需求分析、功能清单、
  流程图、全局说明、详细功能设计、效果验证、非功能性说明。
argument-hint: "[输入文件路径列表]"
allowed-tools: Read Write Edit Bash(mkdir) Read
---

# PRD 生成

## 执行协议

- 整合所有前置分析的输出
- **基于用户模板格式**生成 PRD 文档（8章标准结构）
- 确保文档结构清晰、专业、可直接用于评审
- **读取参考模板**：`templates/prd-templates/[20XXMX][模块名]需求文档模板.md`
- 包含所有必要的产品信息

## PRD 结构（基于用户模板）

用户模板路径：`AI_PM/templates/prd-templates/[20XXMX][模块名]需求文档模板.md`

### 模板章节概览

| 章节 | 内容 | 必需 |
|------|------|------|
| 一、文档概述 | 评审/修订日志 | ✅ |
| 二、需求分析 | 需求背景、需求价值 | ✅ |
| 三、功能清单 | 主要功能说明/清单 | ✅ |
| 四、产品流程 | 业务流程图、页面流程图 | ✅ |
| 五、全局说明 | 名词解释、公共交互、异常处理、分页规则 | 按需 |
| 六、详细功能设计 | 页面/功能点详细设计（表格形式） | ✅ |
| 七、效果验证 | 指标及定义、数据埋点 | ✅ |
| 八、非功能性说明 | 性能、兼容性、未来规划 | 按需 |

## 详细输出格式

输出文件：`{项目目录}/05-PRD-v1.0.md`

**项目目录通过环境变量或参数获取：**
- 优先从 `$PROJECT_DIR` 环境变量读取
- 其次从参数读取
- 默认回退到 `./ai-pm/output/projects/default/`

```markdown
# [产品名]需求文档

---

## 一、文档概述

### 1.1 评审/修订日志

| 日期 | 修订版本 | 修改描述 | 涉及影响模块 | 作者 | 备注 |
|------|---------|---------|-------------|------|------|
| {日期} | v1.0 | 初稿创建 | - | AI_PM | - |

---

## 二、需求分析

### 2.1 需求背景

【阐述需求来源及影响范围】

**需求来源**：{市场反馈 / 主动规划 / 内部优化}

**目标人群及场景**：
- 目标用户：{用户画像}
- 使用场景：{具体场景描述}

**需求影响范围**：
- 用户规模：{预估用户数}
- 覆盖场景：{涉及的业务场景}

**需求痛点**：
{详细描述当前痛点，引用需求分析报告}

### 2.2 需求价值

【阐述预期目标及评估优先级】

**定性描述**：
{产品价值描述}

**定量指标**：

| 指标类型 | 指标名称 | 目标值 | 验收标准 |
|---------|---------|-------|---------|
| 用户指标 | {指标} | {目标} | {标准} |
| 业务指标 | {指标} | {目标} | {标准} |

**优先级评估**：{P0/P1/P2 或 高/中/低}

---

## 三、功能清单

### 3.1 主要功能说明

| 模块 | 功能 | 子功能 | 描述 | 优先级 | 备注 |
|------|------|--------|------|--------|------|
| {模块A} | {功能1} | {子功能} | {功能描述} | P0 | - |
| {模块A} | {功能2} | {子功能} | {功能描述} | P1 | - |
| {模块B} | {功能3} | {子功能} | {功能描述} | P0 | - |

**功能优先级说明**：
- P0：核心功能，必须实现
- P1：重要功能，建议实现
- P2：增值功能，可选实现

---

## 四、产品流程

### 4.1 业务流程图

【阐述整体产品流程及上下游依赖关系】

```
[角色/系统A] → [动作/处理] → [角色/系统B]
     ↓
[判断条件] → 是 → [流程1]
     ↓
    否 → [流程2]
```

**流程说明**：
1. {步骤1描述}
2. {步骤2描述}
3. {步骤3描述}

### 4.2 页面流程图

【阐述产品各页面跳转逻辑】

```
[首页] → 点击{按钮} → [列表页] → 点击{条目} → [详情页]
                              ↓
                        点击{操作} → [编辑页]
```

**页面层级**：
- 一级页面：{页面名}
- 二级页面：{页面名}
- 三级页面：{页面名}

---

## 五、全局说明

### 5.1 名词解释

| 术语 | 解释 | 备注 |
|------|------|------|
| {术语1} | {解释} | - |
| {术语2} | {解释} | - |

### 5.2 公共的交互说明

**弹窗/对话框**：
- 确认弹窗：{交互规则}
- 提示弹窗：{交互规则}

**Toast 提示**：
- 成功提示：显示{时长}秒后自动消失
- 错误提示：显示{时长}秒，可手动关闭

**键盘交互**：
- Enter：{触发动作}
- Esc：{触发动作}

### 5.3 统一异常处理

| 异常类型 | 触发条件 | 处理方式 | 提示文案 |
|---------|---------|---------|---------|
| 网络异常 | 网络断开/超时 | 重试机制 | "网络连接失败，请检查网络后重试" |
| 服务异常 | 服务器返回500 | 降级显示 | "服务繁忙，请稍后再试" |
| 权限异常 | 无操作权限 | 引导申请 | "您暂无权限，请联系管理员" |

### 5.4 列表默认数据、分页

**列表默认规则**：
- 默认排序：{排序字段} {排序方式}
- 默认筛选：{筛选条件}
- 空状态：显示{空状态文案/插图}

**分页规则**：
- 分页方式：{分页/无限滚动}
- 每页数量：{N}条
- 加载更多：滚动到底部自动加载/点击加载更多按钮

---

## 六、详细功能设计

### 6.1 {页面/功能点名称1}

| 项目 | 说明 |
|------|------|
| **用户场景** | 用户在什么场景下要使用该功能 |
| **功能描述** | {功能是什么，解决什么问题} |
| **原型图** | {原型图链接或描述} |
| **优先级** | P0/P1/P2 |
| **输入/前置条件** | {用户身份/状态要求} |
| **需求描述（基本事件流）** | 1. {步骤1}<br>2. {步骤2}<br>3. {步骤3} |
| **需求描述（异常事件流）** | 异常1：{异常场景} → {处理方式}<br>异常2：{异常场景} → {处理方式} |
| **输出/后置条件** | {操作后的系统状态/用户状态变化} |
| **用户权限** | {哪些角色可以使用} |
| **补充说明** | {其他需要注意的事项} |

### 6.2 {页面/功能点名称2}

| 项目 | 说明 |
|------|------|
| **用户场景** | {场景描述} |
| **功能描述** | {功能描述} |
| **原型图** | {原型图} |
| **优先级** | P0/P1/P2 |
| **输入/前置条件** | {前置条件} |
| **需求描述（基本事件流）** | {事件流} |
| **需求描述（异常事件流）** | {异常流} |
| **输出/后置条件** | {后置条件} |
| **用户权限** | {权限} |
| **补充说明** | {补充说明} |

### 6.3 {更多功能点...}
{继续添加功能点表格}

---

## 七、效果验证

### 7.1 指标及定义

【阐述产品线上数据监控指标】

**核心监控指标**：

| 指标分类 | 指标名称 | 指标定义 | 计算方式 | 目标值 |
|---------|---------|---------|---------|-------|
| 用户活跃 | {指标} | {定义} | {计算} | {目标} |
| 功能使用 | {指标} | {定义} | {计算} | {目标} |
| 业务转化 | {指标} | {定义} | {计算} | {目标} |

**监控目的**：
- {监控目的1}
- {监控目的2}

### 7.2 数据埋点

| 埋点事件 | 触发时机 | 事件参数 | 备注 |
|---------|---------|---------|------|
| {事件1} | {触发时机} | {参数} | {说明} |
| {事件2} | {触发时机} | {参数} | {说明} |
| {事件3} | {触发时机} | {参数} | {说明} |

**埋点规范**：
- 事件命名：{module}_{action}_{object}
- 参数规范：使用驼峰命名

---

## 八、非功能性说明

### 8.1 性能需求

| 性能指标 | 要求 | 说明 |
|---------|------|------|
| 页面加载时间 | < 2s | 首屏加载完成 |
| 接口响应时间 | < 500ms | API 返回数据 |
| 并发用户数 | > 10000 | 系统支持 |
| 稳定性 | 99.9% | 系统可用性 |

### 8.2 兼容性需求

**版本兼容**：
- 新版本老数据：{处理方式}
- 老版本新数据：{处理方式}

**平台兼容**：
- 浏览器：Chrome 100+, Safari 15+, Edge 100+
- 移动端：iOS 14+, Android 10+
- 其他：{其他兼容要求}

### 8.3 安全需求

- 用户数据加密存储（AES-256）
- 传输使用 HTTPS/TLS 1.3
- 敏感操作需要身份验证
- 符合数据保护法规

### 8.4 未来规划

【后续版本规划】

| 版本 | 规划功能 | 预计时间 | 备注 |
|------|---------|---------|------|
| v1.1 | {功能} | {时间} | - |
| v1.2 | {功能} | {时间} | - |
| v2.0 | {功能} | {时间} | - |

---

*文档生成时间：{日期} | 生成工具：AI_PM*
```

## 执行步骤

1. **读取参考模板**（可选）：`templates/prd-templates/[20XXMX][模块名]需求文档模板.md`
2. **读取输入文件**：
   - `02-analysis-report.md` - 需求分析
   - `03-competitor-report.md` - 竞品研究
   - `04-user-stories.md` - 用户故事
3. **整合信息**：按8章结构填充内容
4. **生成PRD**：输出到 `{项目目录}/05-PRD-v1.0.md`
5. **展示核心内容**：在终端展示 PRD 的关键摘要

## 生成后展示格式

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ PRD 生成完成！
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📄 文件：{项目目录}/05-PRD-v1.0.md

📋 内容摘要：
   一、文档概述 - 评审日志
   二、需求分析 - {核心痛点}
   三、功能清单 - {N}个功能，P0:{n}个
   四、产品流程 - {主要流程}
   五、全局说明 - 名词/交互/异常/分页
   六、详细设计 - {N}个功能点
   七、效果验证 - {N}个指标，{N}个埋点
   八、非功能性 - 性能/兼容/安全/规划

📊 关键信息：
   - 产品名称：{名称}
   - 功能数量：{总数}（P0:{n} P1:{n} P2:{n}）
   - 核心指标：{北极星指标}

💡 下一步建议：
   - 补充原型图链接
   - 细化数据埋点参数
   - 评审后更新修订日志
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

## 注意事项

- **原型图**：模板中有原型图字段，实际使用时需要补充设计稿链接
- **修订日志**：首次生成时创建 v1.0，后续人工评审后手动更新
- **按需章节**：第5章（全局说明）和第8章（非功能性）如内容简单可简化
- **表格形式**：详细功能设计必须使用表格形式，包含10个字段
