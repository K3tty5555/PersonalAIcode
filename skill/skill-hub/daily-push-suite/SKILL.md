---
name: daily-push-suite
description: |
  每日定时推送套件 - 整合AI热点、万代Hot Toys、游戏折扣三大推送任务。
  包含任务执行、格式规范、健康监控、故障重试等完整功能。
  Use when: 每日推送任务执行、格式检查、健康监控、故障排查。
---

# Daily Push Suite - 每日定时推送套件

## 概述

整合三大每日推送任务，统一调度执行，确保格式规范，提供完整监控。

## 任务清单

| 轮次 | 任务 | 时间 | 内容 |
|------|------|------|------|
| 1 | AI热点推送 | 9:00 | TOP10 AI新闻 |
| 2 | 万代Hot Toys推送 | 9:00+ | 新品发售情报 |
| 3 | 游戏折扣推送 | 9:00++ | Steam/PS/NS折扣 |

## 快速开始

### 手动执行今日推送

```
执行每日三轮推送任务
```

### 检查任务健康状态

```bash
python3 /root/.openclaw/workspace/skills/daily-push-suite/scripts/health_check.py
```

### 查看格式示例

参见 `examples/sample-pushes.md`

## 输出格式规范

### 📰 第1轮：AI热点推送

```
📰 **MM月DD日 AI热点 TOP10**

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

**1️⃣ [标题]**
🏷️ [关键词]
💬 [核心亮点一句话]

**2️⃣ [标题]**
🏷️ [关键词]
💬 [核心亮点一句话]

... (共10条)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 今日AI圈关键词：[关键词] | [关键词] | [关键词]
```

**搜索关键词：**
- 中文：`MM月DD日 AI人工智能新闻`
- 英文：`Month DD YYYY AI artificial intelligence news`

---

### 📅 第2轮：万代Hot Toys推送

```
📅 **MM月DD日 万代 & Hot Toys 新品情报**

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎌 **万代 发售商品**

• **[商品名]** | [系列] | [价格] | [时间]
• **[商品名]** | [系列] | [价格] | [时间]

🔥 **Hot Toys 新品预告**

• **[商品名]** | [系列] | [价格] | [时间]

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💰 汇率：日元 × 0.05 | 港币 × 0.92
```

**搜索关键词：**
- 万代：`万代 BANDAI MM月DD日 发售 新品`
- Hot Toys：`Hot Toys MM月DD日 release new figure`

---

### 🎮 第3轮：游戏折扣推送

```
🎮 **MM月DD日 游戏折扣早报**

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💚 **Steam 今日折扣**

🔥 新史低
• [游戏名] —— [价格]
• [游戏名] —— [价格]

📉 史低
• [游戏名] —— [价格]

⭐ 每日特惠
• [游戏名]

📢 Steam新品节：MM月DD日 - MM月DD日

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔵 **PlayStation Store [活动名]**（至MM月DD日）

• [游戏名] —— [港币价格]（约[人民币]元）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔴 **Nintendo eShop**

[✅/❌ 优惠信息]

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💰 汇率：港币 × 0.89 ≈ 人民币
```

**搜索关键词：**
- Steam：`Steam 今日游戏折扣 MM月DD日`
- PS Store：`PlayStation Store 今日折扣 MM月DD日 PS5`
- NS eShop：`Nintendo eShop 今日折扣 MM月DD日 Switch`

---

## 格式规则

### ✅ 必须遵守
- 使用 **纯文本** 格式（无代码块）
- 使用 `•` 作为列表符号
- 使用 `━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━` 分隔线
- 关键信息 **加粗**
- 使用 emoji：🏷️ 💬 🔥 📉 ⭐ ❌ ✅ 💰
- 每轮完成后 **立即发送**
- 汇率信息放在底部

### ❌ 禁止事项
- Markdown表格 `|` - 飞书显示为代码块
- 三重反引号 ` ``` ` - 创建代码块
- 等全部完成再发送
- 使用模糊日期格式

---

## 健康监控

### 检查命令

```bash
# 检查所有任务
python3 scripts/health_check.py

# 检查指定任务
python3 scripts/health_check.py --job-id <id>
```

### 告警级别

| 级别 | 条件 | 操作 |
|------|------|------|
| 🔴 Critical | 任务禁用 | 立即启用 |
| 🔴 Critical | 连续失败≥2次 | 调查并重试 |
| 🟡 Warning | 运行时间>4分钟 | 监控超时风险 |
| 🟡 Warning | 上次运行失败 | 检查错误并重试 |
| 🟢 OK | 全部正常 | 无需操作 |

### 健康报告格式

```
📊 每日推送套件健康报告
时间：YYYY-MM-DD HH:MM

🟢 每日三轮推送
   状态：运行正常
   上次运行：MM-DD HH:MM | 耗时：XmXs
   三轮全部成功

🟡 [警告示例]
   状态：第2轮运行时间较长
   建议：检查万代搜索是否超时

🔴 [异常示例]
   状态：第3轮发送失败
   错误：[错误信息]
   建议：手动执行游戏折扣推送
```

---

## 故障排查

| 问题 | 原因 | 解决 |
|------|------|------|
| 消息显示为代码块 | 使用了 `\|` 或 ` ``` ` | 改用纯文本格式 |
| 消息未发送 | 多通道未指定channel | 添加 `channel: feishu` |
| 任务超时 | 三轮顺序执行耗时过长 | 超时已设为900s |
| 子代理无法发送 | 隔离会话缺少用户上下文 | 使用主会话或主代理转发 |
| 搜索结果为空 | 日期格式错误或网络问题 | 检查日期格式，重试搜索 |

---

## 任务配置

### 主任务：每日三轮推送

```yaml
job_id: 7d71919d-15fe-46b3-a5da-71c9a335df7b
name: 每日三轮推送
schedule: "0 9 * * *"
timezone: Asia/Shanghai
session_target: main
timeout: 900s
enabled: true
```

### 备用任务（已禁用，可手动启用）

| 任务ID | 名称 | 原定时 |
|--------|------|--------|
| dd791bbe-6585-4182-b8ad-44e6dc737096 | 每日AI热点推送 | 9:00 |
| 8a1406bf-a0de-4ac3-a6bd-c54b9593b6b8 | 万代Hot Toys新品推送 | 9:05 |
| dcd33bff-5f7d-4657-9b6c-9679cca33b3f | 每日游戏折扣推送 | 9:10 |

---

## 文件结构

```
daily-push-suite/
├── README.md                   # 快速入门
├── SKILL.md                    # 详细文档（本文件）
├── examples/
│   └── sample-pushes.md        # 推送示例
├── scripts/
│   └── health_check.py         # 健康检查
└── references/
    └── search-keywords.md      # 搜索关键词参考
```

---

## 更新记录

- **2026-02-27**: 整合四个技能为每日推送套件，优化格式规范